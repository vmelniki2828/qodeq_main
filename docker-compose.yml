services:
  react-build:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - qodeq_front:/qodeq_front
    command: >
      sh -c "rm -rf /qodeq_front/* &&
             cp -r /app/build/* /qodeq_front/"
  nginx:
    image: nginx:latest
    container_name: nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
      - qodeq_front:/var/www/html/qodeq_front
      - ./nginx/certs/fullchain.pem:/tmp/ssl/fullchain.pem
      - ./nginx/certs/privkey.pem:/tmp/ssl/privkey.pem

volumes:
  qodeq_front:
